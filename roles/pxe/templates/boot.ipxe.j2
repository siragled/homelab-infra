#!ipxe
# {{ organization_name }} - PXE Boot Menu
# Generated by Ansible - do not edit manually

# Set console parameters
console --picture --left 100 --right 80

# Branding
echo
echo ===============================================================================
echo {{ organization_name }} - Network Boot Menu
echo ===============================================================================
echo Architecture: ${buildarch}
echo MAC Address:  ${mac}
echo IP Address:   ${ip}
echo Hostname:     ${hostname}
echo ===============================================================================
echo

# Architecture detection and redirect
iseq ${buildarch} x86_64 && goto amd64 ||
iseq ${buildarch} arm64 && goto arm64 ||
goto unsupported

:amd64
echo Detected x86_64 architecture
chain http://{{ pxe_next_server }}/ipxe/boot-amd64.ipxe
goto end

:arm64  
echo Detected ARM64 architecture
chain http://{{ pxe_next_server }}/ipxe/boot-arm64.ipxe
goto end

:unsupported
echo Unsupported architecture: ${buildarch}
echo Falling back to netboot.xyz...
chain --autofree https://boot.netboot.xyz
goto end

:end
# Should not reach here
echo Boot process failed
sleep 10
reboot
